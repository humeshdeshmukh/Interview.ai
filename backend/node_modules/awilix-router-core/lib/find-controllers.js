"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var glob = require("glob");
var state_util_1 = require("./state-util");
/**
 * Finds classes using the specified pattern and options.
 *
 * @param pattern Glob pattern
 * @param opts Glob options
 */
function findControllers(pattern, opts) {
    var result = glob.sync(pattern, opts);
    return result
        .map(function (path) {
        var items = [];
        var required = require(path);
        if (required) {
            var stateAndTarget = state_util_1.getStateAndTarget(required);
            if (stateAndTarget) {
                items.push(stateAndTarget);
                return items;
            }
            // loop through exports - this will cover named as well as a default export
            for (var _i = 0, _a = Object.keys(required); _i < _a.length; _i++) {
                var key = _a[_i];
                items.push(state_util_1.getStateAndTarget(required[key]));
            }
        }
        return items;
    })
        .reduce(function (acc, cur) { return acc.concat(cur); }, [])
        .filter(function (x) { return x !== null; });
}
exports.findControllers = findControllers;
//# sourceMappingURL=find-controllers.js.map